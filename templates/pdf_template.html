<!DOCTYPE html>
<html>
<head>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <meta charset="utf-8">
    <title>{{ story.title }}</title>
    <style>
    @page {
        size: a4 portrait;
        margin: 0;
    }

    body {
        font-family: 'Literata', "DejaVu Sans", serif;
        margin: 0;
        color: #333;
    }
    .page {
        page-break-after: always;
        position: relative;
        width: 210mm;
        height: 297mm;
        overflow: hidden;
    }

    .text-overlay {
        position: absolute;
        bottom: 10%;
        left: 10%;
        right: 10%;
        background: rgba(255, 255, 255, 0.8);
        color: #333;
        padding: 20px;
        text-align: justify;
        font-size: 20pt;
        border-radius: 15px;
        line-height: 1.5;
    }

    /* Cover Page */
    /* The .cover-page class is a marker and inherits all styles from .page */
    .cover-banner {
        position: absolute;
        top: 40%;
        left: 0;
        width: 100%;
        background: rgba(0, 0, 0, 0.5);
        padding: 15px 0;
        border-top: 3px solid white;
        border-bottom: 3px solid white;
    }
    .cover-title {
        font-family: 'MedievalSharp', serif;
        margin: 0;
        text-align: center;
        color: white;
        font-size: 60pt;
        text-shadow: 3px 3px 5px rgba(0,0,0,0.7);
    }

    </style>
</head>
<body>

    <!-- Cover Page -->
    <div class="page cover-page">
        {% if story.images and story.images[0].url %}
            <img src="{{ story.images[0].url }}" style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; z-index: -1;">
        {% endif %}
        <div class="cover-banner">
            <h1 class="cover-title">{{ story.title }}</h1>
        </div>
    </div>

    <!-- Story Pages -->
    {% for i in range(story.paragraphs|length) %}
        <div class="page">
            {% if i < story.images|length and story.images[i].url %}
                <img src="{{ story.images[i].url }}" style="width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; z-index: -1;">
            {% endif %}
            <div class="text-overlay">
                <p>{{ story.paragraphs[i] }}</p>
            </div>
        </div>
    {% endfor %}

</body>
</html>